# Debug Session Log - I2C Scanner & Serial Communication

**Date:** 2025-01-28  
**Tool:** Embedder  
**Board:** Seeed XIAO ESP32-S3  
**Serial Port:** `/dev/cu.usbmodem2101`  
**Baud Rate:** 115200  

---

## Observer Notes (User Perspective)

> "I heard small clicks but nothing worked on the board - whatever you did"

The user observed:
- Audible clicking sounds from the board (likely relay/power cycling during flash)
- No visible response or indication of firmware running
- Multiple flash attempts occurred

---

## Session Timeline

### Problem 1: Serial Monitor Not Receiving Data

**Symptom:** Serial monitor commands timed out with no output.

**Attempted Solutions:**
1. `cat /dev/cu.usbmodem2101` - Timed out after 8 seconds, no data
2. Tried cycling DTR/RTS lines to reset board - No effect
3. Multiple serial monitor attempts - All timed out

**Root Cause:** The existing firmware was not producing serial output properly.

---

### Solution: Simplified Test Firmware

Replaced complex I2C scanner with minimal "Hello World" to verify serial works:

```cpp
// Minimal test firmware
#include <Arduino.h>

void setup() {
    Serial.begin(115200);
    delay(2000);
}

void loop() {
    static int count = 1;
    Serial.print("Hello, World! ");
    Serial.println(count++);
    delay(1000);
}
```

**Result:** SUCCESS - Serial output confirmed working:
```
Hello, World! 1
Hello, World! 2
Hello, World! 3
Hello, World! 4
Hello, World! 5
```

---

### Problem 2: I2C Device Discovery

After confirming serial worked, restored full I2C scanner firmware.

**I2C Scanner Code:** `src/i2c_scanner.cpp`

Scans multiple pin configurations:
- `Wire.begin()` - Default pins
- `Wire.begin(5, 6)` - GPIO5/6 (D4/D5 external header)
- `Wire.begin(4, 5)` - GPIO4/5
- `Wire.begin(8, 9)` - GPIO8/9
- `Wire.begin(41, 42)` - GPIO41/42

---

## I2C Scan Results

| Address | Device Identified | Notes |
|---------|-------------------|-------|
| `0x3C`  | SSD1306 OLED Display | Common 128x64 OLED |
| `0x51`  | Unknown | Possibly EEPROM, RTC, or sensor module |

**Devices NOT Found:**
- `0x6A/0x6B` - LSM6DS3/LSM6DSOX IMU (expected on Sense board)
- `0x76/0x77` - BME280/BMP280 environmental sensor
- `0x10` - VEML7700 light sensor

---

## Build & Flash Log

```
Platform: Espressif 32 (6.12.0)
Board: Seeed Studio XIAO ESP32S3
MCU: ESP32S3 @ 240MHz
RAM: 320KB
Flash: 8MB
PSRAM: 8MB (embedded)

Firmware Size:
- RAM:   5.5% (18104 / 327680 bytes)
- Flash: 8.0% (267277 / 3342336 bytes)

Upload: SUCCESS via esptool @ 460800 baud
```

---

## Files Modified This Session

| File | Action | Description |
|------|--------|-------------|
| `src/i2c_scanner.cpp` | Modified | Simplified to Hello World, then restored to full I2C scanner |

---

## Hardware Observations

1. **Board responds to flash commands** - esptool connects successfully
2. **USB-Serial/JTAG mode active** - Using built-in USB, not external UART
3. **Hard reset via RTS pin works** - Board resets after flash
4. **Clicking sounds heard** - Normal during flash/reset cycle

---

## Conclusions

1. **Serial communication is functional** at 115200 baud
2. **I2C bus is working** - Two devices detected
3. **OLED display present** at 0x3C (SSD1306)
4. **Unknown device at 0x51** - Needs identification
5. **No IMU detected** - The XIAO ESP32-S3 base board has no onboard IMU; requires the "Sense" expansion board

---

## Next Steps

1. Identify the device at address 0x51
2. Verify if the Sense expansion board is attached (contains IMU + camera + mic)
3. Connect external sensors (BME280, VEML7700) if needed for avalanche trigger project
4. Test with actual sensor hardware once available

---

## Commands Reference

```bash
# Build and upload
pio run --target upload

# Monitor serial output
pio device monitor -b 115200

# Or use screen
screen /dev/cu.usbmodem2101 115200
```

---

*Log generated by Embedder - I2C debugging session*
